var e=Object.defineProperty,t=(t,s,n)=>((t,s,n)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n)(t,"symbol"!=typeof s?s+"":s,n);import{r as s,g as n}from"./phaser-DJkhv3Fe.js";function i(e){console.error(`[ERROR] ${e.message}`),e.filename&&console.error(`File: ${e.filename} at ${e.lineNumber}:${e.columnNumber}`),e.stack&&console.error(`Stack: ${e.stack}`)}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const r=n(s());class o extends Phaser.Scene{constructor(e){super(e)}get cameraCenter(){return{x:this.cameras.main.centerX,y:this.cameras.main.centerY}}get cameraDimensions(){return{width:this.cameras.main.width,height:this.cameras.main.height}}}const a=class e extends Phaser.GameObjects.Container{constructor({scene:e,position:s,dimensions:n}){super(e,s.x,s.y),t(this,"loadingPercentText"),t(this,"loadingBar"),t(this,"MAX_WIDTH",220);const i={width:0,height:.8*n.height};this.setupBackground(n),this.setupBar(i),this.setupLoadingPercentText(),e.add.existing(this)}setupBackground(e){const t=this.scene.add.rectangle(0,0,e.width,e.height,3355443);this.add(t)}setupBar(e){this.loadingBar=this.scene.add.rectangle(0,0,e.width,e.height,16777215),this.add(this.loadingBar)}setupLoadingPercentText(){const t=e.DEFAULT_PERCENT_TEXT;this.loadingPercentText=this.scene.add.text(0,0,t,{fontSize:"11px",color:"#000000"}).setOrigin(.5),this.add(this.loadingPercentText)}updateProgress(e){if(!(e>=0&&e<=1))throw new Error("Invalid argument");const t=100*e;this.loadingPercentText.setText(`${t.toFixed(0)}%`),this.loadingBar.setSize(this.MAX_WIDTH*e,this.loadingBar.height)}};t(a,"DEFAULT_PERCENT_TEXT","0%");let c=a;function d(e){const{scene:t,target:s,duration:n,onComplete:i}=e;t.tweens.add({targets:s,alpha:0,duration:n,onComplete:i})}function h(e){const{scene:t,target:s,duration:n,onComplete:i}=e;t.tweens.add({targets:s,alpha:1,duration:n,onComplete:i})}function l(e){const{scene:t,nextSceneKey:s,durationAnim1:n=500,durationAnim2:i=500}=e;if(!(t instanceof Phaser.Scene))throw new Error("Invalid argument: scene isn't an instance of Phaser.Scene");d({scene:t,target:t.cameras.main,duration:n,onComplete:()=>{t.scene.start(s);const e=t.scene.get(s);e.events.once(Phaser.Scenes.Events.CREATE,(()=>{e.cameras.main.alpha=0,h({scene:e,target:e.cameras.main,duration:i,onComplete:()=>{}})}))}})}function u(e){const{scene:t,target:s,duration:n,onComplete:i}=e;h({scene:t,target:s,duration:n,onComplete:()=>{d({scene:t,target:s,duration:n,onComplete:i})}})}const g=class e extends Phaser.GameObjects.Container{constructor({scene:s,x:n,y:i,text:r,background:o,onClick:a}){super(s,n,i),t(this,"textElement"),t(this,"backgroundElement"),t(this,"isEnabled",!0),o&&this.setupBackground(o),this.setupText(r??e.DEFAULT_TEXT),this.setupEvents(a??(()=>{})),this.setupHitbox(),this.scene.add.existing(this)}setupText(t){this.textElement=this.scene.add.text(0,0,t,{fontSize:e.DEFAULT_FONT_SIZE+"px"}).setOrigin(e.DEFAULT_ORIGIN),this.add(this.textElement)}setupBackground(t){this.backgroundElement=this.scene.add.image(0,0,t).setOrigin(e.DEFAULT_ORIGIN),this.add(this.backgroundElement)}setupHitbox(){const e=this.backgroundElement??this.textElement;this.setSize(e.width,e.height),this.setInteractive({useHandCursor:!0})}setupEvents(e){const t=[this.backgroundElement,this.textElement].filter(Boolean);this.onPointerOverEvent(t),this.onPointerOutEvent(t),e&&this.onClickEvent(e)}onClickEvent(e){this.on("pointerdown",(()=>{this.isEnabled&&e()}))}onPointerOverEvent(e){this.on("pointerover",(()=>{this.isEnabled&&(this.scene.tweens.killTweensOf(e),this.scene.tweens.add({targets:e,scale:1.04,duration:100}))}))}onPointerOutEvent(e){this.on("pointerout",(()=>{this.isEnabled&&(this.scene.tweens.killTweensOf(e),this.scene.tweens.add({targets:e,scale:1,duration:100}))}))}setEnabled(e){const t=e?1:.5;this.isEnabled=e,this.setAlpha(t),this.disableInteractive(),e&&this.setInteractive({useHandCursor:!0})}destroy(e){this.removeAllListeners(),super.destroy(e)}};t(g,"DEFAULT_FONT_SIZE",10),t(g,"DEFAULT_TEXT","Click me"),t(g,"DEFAULT_ORIGIN",.5);let m=g;window.addEventListener("error",(function(e){const{message:t,filename:s,lineno:n,colno:r,error:o}=e;i({message:t,filename:s,lineNumber:n,columnNumber:r,stack:null==o?void 0:o.stack})})),window.addEventListener("unhandledrejection",(function(e){const t=e.reason;i({message:(null==t?void 0:t.message)||"Unhandled Promise Rejection",stack:(null==t?void 0:t.stack)||String(t)})}));const p={title:"A ruína de Arquimedes",type:r.WEBGL,pixelArt:!0,scale:{mode:r.Scale.FIT,autoCenter:r.Scale.CENTER_BOTH,width:427,height:240},parent:"game-container",render:{antialias:!1,antialiasGL:!1,pixelArt:!0},roundPixels:!0,physics:{default:"arcade",arcade:{debug:!1,fps:24,timeScale:1,gravity:{x:0,y:0},tileBias:16}},scene:[class extends o{constructor(){super("Boot")}preload(){this.load.on("complete",(()=>this.addEventsToGoToNextScene()))}create(){const e=this.cameraCenter;this.createContinueText(e)}createContinueText(e){!function(e){const{scene:t,target:s,othersConfigs:n}=e;t.tweens.add({targets:s,alpha:n.alpha||0,duration:n.duration||1e3,yoyo:n.yoyo||!0,repeat:n.repeat||-1})}({scene:this,target:this.add.text(e.x,e.y,"Press any key or click to start the game",{fontSize:12}).setOrigin(.5),othersConfigs:{duration:1e3}})}addEventsToGoToNextScene(){var e;null==(e=this.input.keyboard)||e.on("keydown",(()=>{this.scene.start("Preloader"),this.removeEventsToGoToNextScene()})),this.input.on("pointerdown",(()=>{this.scene.start("Preloader"),this.removeEventsToGoToNextScene()}))}removeEventsToGoToNextScene(){var e;null==(e=this.input.keyboard)||e.off("keydown"),this.input.off("pointerdown")}},class extends o{constructor(){super("Preloader"),t(this,"preloaderUI")}init(){this.preloaderUI=this.scene.get("PreloaderUI"),this.scene.launch(this.preloaderUI,{preloader:this})}preload(){this.load.setPath("assets"),this.load.image("logo","logos/logo_en.png"),this.load.image("logo-phaser","logos/logo_phaser.png"),this.load.image("background","backgrounds/background_test.png"),this.load.image("button","buttons/button-test.png")}},class extends o{constructor(){super("PreloaderUI"),t(this,"preloader"),t(this,"loadingBar"),t(this,"currentAssetInLoadingText")}init(e){this.preloader=e.preloader,this.createUI(),this.setupLoadingEvents()}setupLoadingEvents(){this.preloader.load.on("progress",this.loadingBar.updateProgress.bind(this.loadingBar)),this.preloader.load.on("fileprogress",this.updateCurrentAssetText.bind(this)),this.preloader.load.on("complete",this.onCompleteLoading.bind(this))}createUI(){const e=this.cameraCenter,t={x:e.x,y:1.05*e.y},s={x:e.x,y:.9*e.y},n={x:e.x,y:1.18*e.y};this.createLoadingBar(t,{width:226,height:16}),this.createStaticLoadingText(s),this.createCurrentAssetText(n)}createLoadingBar(e,t){this.loadingBar=new c({scene:this,position:e,dimensions:t})}createStaticLoadingText(e){this.add.text(e.x,e.y,"Loading").setOrigin(.5)}createCurrentAssetText(e){this.currentAssetInLoadingText=this.add.text(e.x,e.y,"Asset: ",{color:"#c1c1c1",fontSize:10}).setOrigin(.5)}updateCurrentAssetText(e){this.currentAssetInLoadingText.setText(`Asset: ${e.key}`)}onCompleteLoading(){l({scene:this,nextSceneKey:"Intro",durationAnim1:1e3,durationAnim2:1e3})}},class extends o{constructor(){super("Intro"),t(this,"DEFAULT_DELAY",1500),t(this,"TEXT_STYLE",{fontSize:14,color:"#fff",align:"center"})}create(){this.createBackground();const e=this.cameraCenter,t=.7*e.y;this.showPhaserIntro(e,t)}createBackground(){const e=this.cameraDimensions;this.add.image(e.width/2,e.height/2,"background").setDisplaySize(e.width,e.height).setAlpha(.13,0,0,.13)}showPhaserIntro(e,t){u({scene:this,target:this.createIntroElements(e,t,"logo-phaser",.03,"Powered by Phaser"),duration:this.DEFAULT_DELAY,onComplete:()=>{this.showGameIntro(e,t)}})}showGameIntro(e,t){u({scene:this,target:this.createIntroElements(e,t,"logo",.25,"A Ruína de Arquimedes"),duration:this.DEFAULT_DELAY,onComplete:()=>{this.transitionToMainMenu()}})}createIntroElements(e,t,s,n,i){const r=this.add.image(e.x,t,s).setScale(n).setAlpha(0),o=1.4*e.y;return[r,this.add.text(e.x,o,i,this.TEXT_STYLE).setOrigin(.5).setAlpha(0)]}transitionToMainMenu(){l({scene:this,nextSceneKey:"MainMenu",durationAnim1:this.DEFAULT_DELAY,durationAnim2:this.DEFAULT_DELAY})}},class extends o{constructor(){super("MainMenu")}create(){this.createBackground(),this.createLogo(),this.createPrincipalButtons()}createBackground(){const e=this.cameraDimensions,t={x:e.width/2,y:e.height/2};this.add.image(t.x,t.y,"background").setDisplaySize(e.width,e.height).setAlpha(0,0,0,.3)}createLogo(){const e={x:85,y:.5*this.cameraCenter.y};this.add.image(e.x,e.y,"logo").setDisplaySize(150,75).setOrigin(.5)}createPrincipalButtons(){const e=[{text:"Start",callback:()=>this.scene.start("InProgressScene")},{text:"Options"},{text:"Credits"},{text:"Exit"}],t=this.cameraCenter.y;e.forEach(((e,s)=>{new m({scene:this,x:30,y:t+18*s,text:e.text,onClick:e.callback})}))}},class extends o{constructor(){super("MainGame")}create(){}},class extends o{constructor(){super("GameOver")}create(){}},class extends o{constructor(){super("InProgressScene")}create(){this.createLogo(),this.createInProgressText()}createLogo(){const e={x:this.cameraCenter.x,y:.5*this.cameraCenter.y};this.add.image(e.x,e.y,"logo").setDisplaySize(200,100)}createInProgressText(){const e={x:this.cameraCenter.x,y:1.3*this.cameraCenter.y};this.add.text(e.x,e.y,"IN PROGRESS.").setOrigin(.5)}}]};new r.Game(p);
